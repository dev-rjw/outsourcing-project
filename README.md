# ì»¤íŠ¼ì½œ ğŸ­ [outsourcing-project]

[ë©”ì¸í˜ì´ì§€] ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-20 á„‹á…©á„’á…® 4 45 08](https://github.com/user-attachments/assets/6e929713-6ba0-4e00-b423-bd1f2cec40a2)

[ìƒì„¸í˜ì´ì§€] <img width="1224" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-20 á„‹á…©á„’á…® 4 13 01" src="https://github.com/user-attachments/assets/1d4c5324-ec12-4c0b-8e99-024fde72e82a">

[ì»¤ë®¤ë‹ˆí‹° í˜ì´ì§€]

[ì¹´í…Œê³ ë¦¬ í˜ì´ì§€] <img width="1224" alt="í™”ë©´ìº¡ì²˜_2024-09-20_192523" src="src/assets/í™”ë©´ìº¡ì²˜_2024-09-20_192523.png">

---

## íŒ€ ì†Œê°œ

[ë‚´ì¼ë°°ì›€ìº í”„] 5ì§„ìŠ¤

## ğŸ‘¨â€ğŸ« í”„ë¡œì íŠ¸ ì†Œê°œ

## ê³µì—°ì„ ê³µìœ í•˜ê³  ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€

## ğŸš© í”„ë¡œì íŠ¸ ê°œìš”

- **í”„ë¡œì íŠ¸ëª…** &nbsp; :&nbsp; **ì»¤íŠ¼ì½œ**
- **ì§„í–‰ ê¸°ê°„** &nbsp;: &nbsp; **24.09.11 ~ 24.09.23**

---

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ íŒ€ì› ì†Œê°œ

|   ì •ì†Œí˜„   |      ê°•ë‹¤ì—°      |        ë¥˜ì§€ì›        |  ë°•ê·œë¦¬  |         ì¡°í•´ì¸         |
| :--------: | :--------------: | :------------------: | :------: | :--------------------: |
|  **íŒ€ì›**  |     **íŒ€ì›**     |       **íŒ€ì¥**       | **íŒ€ì›** |        **íŒ€ì›**        |
| ìƒì„¸í˜ì´ì§€ | ë¡œê·¸ì¸, íšŒì›ê°€ì… | ì¹´í…Œê³ ë¦¬, í—¤ë”, í‘¸í„° | ì»¤ë®¤ë‹ˆí‹° | ë©”ì¸í˜ì´ì§€, í—¤ë”, í‘¸í„° |

---

## ğŸ“š STACKS

<div align=Left>
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black">
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white">
<img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white">
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black">
<img src="https://img.shields.io/badge/styled Components-DB7093?style=for-the-badge&logo=styledcomponents&logoColor=white">
<img src="https://img.shields.io/badge/reactrouter-CA4245?style=for-the-badge&logo=reactrouter&logoColor=white">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/git actions-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/Notion-000000?style=for-the-badge&logo=Notion&logoColor=white">
<img src="https://img.shields.io/badge/VSCODE-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
<img src="https://img.shields.io/badge/VERCEL-007ACC?style=for-the-badge&logo=VERCEL&logoColor=white">
<img src="https://img.shields.io/badge/SLACK-green?style=for-the-badge&logo=SLACK&logoColor=white">
<img src="https://img.shields.io/badge/TailwindCss-06B6D4?style=for-the-badge&logo=java&logoColor=white">
</div>

---

## ì„¤ì¹˜ íŒ¨í‚¤ì§€

- í”„ë¡œì íŠ¸ ì„¸íŒ… : yarn create vite --template react
  - ì‹¤í–‰ : yarn dev
- json-server ì„¤ì¹˜ : yarn add json-server
  - ì‹¤í–‰ : yarn json-server db.json --port 4000
- tanstack query ì„¤ì¹˜ : yarn add @tanstack/react-query @tanstack/react-query-devtools
- axios ì„¤ì¹˜ : yarn add axios
- tailwind css ì„¤ì¹˜ : yarn add -D tailwindcss postcss autoprefixer
  - tailwind.config.js íŒŒì¼ ìƒì„± : npx tailwindcss init -p
- react-router-dom ì„¤ì¹˜ : yarn add react-router-dom
- zustand ì„¤ì¹˜ : yarn add zustand
- styled-component ì„¤ì¹˜ : yarn add styled-component
- embla(ìºëŸ¬ì…€ ë¼ì´ë¸ŒëŸ¬ë¦¬) : yarn add embla-carousel-react embal-carousel-autoplay
- the-new-css-reset ì„¤ì¹˜ : yarn add the-new-css-reset

---

## âœ”ï¸ Code Convention

- ES Lint , prettier ì‚¬ìš©
- ì»´í¬ë„ŒíŠ¸ì¼ ê²½ìš°ì—ë§Œ .jsxí™•ì¥ì ì‚¬ìš©
- customHookì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° : use + í•¨ìˆ˜ëª…
- Propsì˜ ê²½ìš°: on (onClick ë“±ë“±)
- í•¨ìˆ˜ì¸ ê²½ìš°: handle (handleClick ë“±ë“±)
- ìƒìˆ˜ : ëª¨ë‘ ëŒ€ë¬¸ì ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤(snake_case) ì˜ˆì‹œ) SNAKE_CASE
- js(ë³€ìˆ˜, í•¨ìˆ˜, ì¸ìŠ¤í„´ìŠ¤) : ì¹´ë©œ ì¼€ì´ìŠ¤(camelCase) ì˜ˆì‹œ) const createMovie = [];
- css, html : ì¼€ë°¥ ì¼€ì´ìŠ¤(kebab-case) ì˜ˆì‹œ)Â `<div class="movie-items"></div>`
- image ëª… : ì¼€ë°¥ ì¼€ì´ìŠ¤(kebab-case) ì˜ˆì‹œ) movie-img.jpg
- ì£¼ì„ ìµœëŒ€í•œ í™œìš©í•˜ê¸° : í•´ë‹¹ ì½”ë“œ ì œëª©, ì„¤ëª… ê°„ë‹¨í•˜ê²Œ ì ì–´ë†“ê¸°
- ì•½ì¹­ì€ ë˜ë„ë¡ ì‚¬ìš©í•˜ì§€ ì•Šê¸°

## âœ”ï¸ Git Commit Convention

ì‘ì—… íƒ€ì… ì‘ì—…ë‚´ìš©

- update : í•´ë‹¹ íŒŒì¼ì— ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ìƒê¹€
- add : ì—†ë˜ íŒŒì¼ì„ ìƒì„±í•¨, ì´ˆê¸° ì„¸íŒ…
- bugfix : ë²„ê·¸ ìˆ˜ì •
- refactor : ì½”ë“œ ë¦¬íŒ©í† ë§
- fix : ì½”ë“œ ìˆ˜ì •
- move : íŒŒì¼ ì˜®ê¹€/ì •ë¦¬
- del : ê¸°ëŠ¥/íŒŒì¼ì„ ì‚­ì œ
- test : í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±
- style : css
- gitfix : gitignore ìˆ˜ì •
- script : package.json ë³€ê²½(npm ì„¤ì¹˜ ë“±)

## ğŸ—‚ï¸ ê¸°ëŠ¥ ì„¤ëª…

#### ë©”ì¸ í˜ì´ì§€

---

#### ìƒì„¸ í˜ì´ì§€

- ê³µì—° ì„¸ë¶€ ì•ˆë‚´ ì‚¬í•­
- ê³µì—° ì¥ì†Œ (ì¹´ì¹´ì˜¤ ì§€ë„ ì¡°íšŒ ê°€ëŠ¥)
- ê³µì—° ëŒ“ê¸€ ì¡°íšŒ
- ê³µì—° ëŒ“ê¸€ ì‘ì„± ë° ì‚­ì œ

1. ê³µì—° apiì—°ê²° + tanstackQuery dataì €ì¥

```jsx
// detailApi.js
// ê³µì—° ìƒì„¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
export const fetchDetailData = async (id) => {
  const url = `http://kopis.or.kr/openApi/restful/pblprfr/${id}?service=${apiKey}`;

  try {
    const response = await axios.get(url);
    const jsonData = parseXMLToJSON(response.data);
    console.log(jsonData); // ë³€í™˜ëœ JSON ë°ì´í„° ì½˜ì†” ì¶œë ¥
    return jsonData;
  } catch (error) {
    console.error("DetailDataError", error);
    throw new Error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  }
};
```

```jsx
const { id } = useParams();

// ê³µì—° ìƒì„¸ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
const {
  data,
  isLoading: detailLoading,
  isError: detailError,
} = useQuery({
  queryKey: ["performanceDetail", id],
  queryFn: () => fetchDetailData(id),
});
const detailData = data?.dbs?.db;

if (detailLoading) {
  return <div>Loading...</div>;
}

if (detailError || !detailData) {
  return <div>Error</div>;
}
```

2. ì§€ë„ apiì—°ê²° + ì¹´ì¹´ì˜¤ map SDKì‚¬ìš©

```js
// detailApi.js
// ê³µì—° ì¥ì†Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
export const fetchMapData = async (placeId) => {
  const mapUrl = `http://www.kopis.or.kr/openApi/restful/prfplc/${placeId}?service=${apiKey}`;

  try {
    const response = await axios.get(mapUrl);
    const jsonData = parseXMLToJSON(response.data);
    return jsonData;
  } catch (error) {
    console.error("Map Error", error);
    throw new Error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  }
};
```

```js
// DetailMap.jsx
import React from "react";
import { useQuery } from "@tanstack/react-query";
import { Map, MapMarker, ZoomControl } from "react-kakao-maps-sdk";
import { fetchMapData } from "../../api/detailApi";

const DetailMap = ({ detailData }) => {
  const placeId = detailData?.mt10id;
  const { data, isLoading, isError } = useQuery({
    queryKey: ["mapData", placeId],
    queryFn: () => fetchMapData(placeId),
    enabled: !!placeId,
  });

  const mapData = data?.dbs?.db;

  if (isLoading) {
    return <div>Loading...</div>;
  }

  if (isError) {
    return <div>Error</div>;
  }

  if (!mapData) {
    return <div>ì¥ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>;
  }

  // ì¢Œí‘œê°’ì„ ìˆ«ìë¡œ ë³€í™˜
  const lat = parseFloat(mapData.la);
  const lng = parseFloat(mapData.lo);

  return (
      <Map
        center={{ lat, lng }} // ì¢Œí‘œê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ ì„¤ì •
        style={{ width: "100%", height: "500px" }}
        level={3}
      >
        <MapMarker position={{ lat, lng }} />
        <ZoomControl />
      </Map>
    </div>
  );
};

export default DetailMap;

```

3. ëŒ“ê¸€ ì‘ì„±, ì‚­ì œ + db.jsoní™œìš©

```js
// detailApi.js
// ìƒì„¸í˜ì´ì§€ ëŒ“ê¸€ ì‘ì„± ê¸°ëŠ¥
const jsonUrl = import.meta.env.VITE_DB_URL + "/comments";
const commentApi = axios.create({ baseURL: jsonUrl });

// ëŒ“ê¸€ ì¶”ê°€
export const detailAddComment = async (newComment) => {
  const { data } = await commentApi.post("/", newComment);
  return data;
};

// íŠ¹ì • ê³µì—°ì˜ ëŒ“ê¸€ ê°€ì ¸ì˜¤ê¸°
export const detailGetComment = async (performanceId) => {
  const { data } = await commentApi.get("/");
  return data.filter((comment) => comment.performanceId === performanceId);
};

// ëŒ“ê¸€ ì‚­ì œ
export const detailDeleteComment = async (id) => {
  const { data } = await commentApi.delete(`/${id}`);
  return data;
};
```

```js
// DetailComment.jsx
const addMutation = useMutation({
  mutationFn: (newComment) => detailAddComment({ ...newComment, performanceId: id }),
  onSuccess: () => {
    queryClient.invalidateQueries(["comments", id]);
    setComment("");
  },
});

// ëŒ“ê¸€ ì‚­ì œ mutation
const removeMutation = useMutation({
  mutationFn: detailDeleteComment,
  onSuccess: () => {
    queryClient.invalidateQueries(["comments", id]);
  },
});

// ëŒ“ê¸€ ê°€ì ¸ì˜¤ê¸° query
const {
  data: comments = [],
  isLoading,
  isError,
} = useQuery({
  queryKey: ["comments", id],
  queryFn: () => detailGetComment(id),
});
```

---

#### ì»¤ë®¤ë‹ˆí‹°

---

#### ì¹´í…Œê³ ë¦¬

- í•„í„°ë§ ì¶”ê°€
  - ê²€ìƒ‰
  - ì‹œì‘ë‚ ì§œ/ì¢…ë£Œë‚ ì§œ
  - ì§€ì—­ë³„
  - ì¥ë¥´ë³„
- í•„í„°ë§ì— ë”°ë¥¸ ê³µì—° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥
- í•´ë‹¹ ê³µì—° í´ë¦­ ì‹œ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™

1. db.json ì„œë²„ ì‚¬ìš©í•˜ì—¬ ê³µì—° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥

```js
import axios from "axios";
import { genreCodes } from "../utils/Kopis-api-common";
import { getDateString, parseXMLToJSON } from "../utils/utils";

// KOPIS ê´€ë ¨
const BASE_URL = "http://kopis.or.kr/openApi/restful/pblprfr";

const playApi = axios.create({ baseURL: BASE_URL });

export const getGenreAreaData = async (genre, area, row, startDate, endDate) => {
  try {
    const { data } = await playApi.get("/", {
      params: {
        service: import.meta.env.VITE_KOPIS_KEY,
        stdate: startDate,
        eddate: endDate,
        rows: row,
        cpage: 1,
        shcate: genre === "ì¥ë¥´ë³„" ? null : genre,
        signgucode: area === "ì§€ì—­ë³„" ? null : area,
      },
    });

    const result = parseXMLToJSON(data).dbs;
    if (result) {
      return result.db;
    } else {
      return [];
    }
  } catch (error) {
    console.error("Error fetching performance details:", error);
    throw new Error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  }
};

export const searchGenreAreaData = async (searchValue, genre, area, row, startDate, endDate) => {
  const allData = await getGenreAreaData(genre, area, row, startDate, endDate);

  const data = allData.filter((data) => {
    return String(data["prfnm"]).includes(searchValue);
  });
  return data;
};
```

---

## ğŸ’¥ Trouble Shooting

[ë©”ì¸í˜ì´ì§€]

---

[ìƒì„¸í˜ì´ì§€]

ğŸ”¥ ë¬¸ì œì 

1. zustandì—ì„œ tanstackQueryë¡œì˜ ì½”ë“œ ë¦¬í™í† ë§

- ë¶ˆí•„ìš”í•˜ê²Œ ìƒì„¸í˜ì´ì§€ ì •ë³´ì™€ ì§€ë„ë°ì´í„° ì •ë³´ë¥¼ zustandì—ì„œ ì „ì—­ìƒíƒœê´€ë¦¬ë¥¼ í•˜ì—¬ data, loadingê³¼ errorë¥¼ useStateë¡œ ì €ì¥í•˜ê³  useEffectë¥¼ í™œìš©í•˜ì—¬ ìƒíƒœë³€í™”ê°€ ìƒê¸¸ ë•Œë§ˆë‹¤ ë Œë”ë§ í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ëŠ”ë° tanstackQueryë¡œ ë¦¬í™í† ë§í•˜ì—¬ isLoading, isError, useQueryë¥¼ ì‚¬ìš©í•˜ì—¬ ë³´ë‹¤ í¸ë¦¬í•˜ê²Œ ìƒíƒœê´€ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

```js
// zustandì½”ë“œ
// useKopisStore.js
import { create } from "zustand";
import { fetchDetailData, fetchMapData } from "../api/detailApi";

const useKopisStore = create((set, get) => ({
  data: null,
  mapData: null,
  error: null,

  // ê³µì—° ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
  fetchData: async (id) => {
    try {
      const result = await fetchDetailData(id);
      if (result && result.dbs && result.dbs.db) {
        set({ data: result.dbs.db, error: null });
      } else {
        set({ error: "No data found", data: null });
      }
    } catch (error) {
      set({ error: `Error fetching details: ${error.message}`, data: null });
    }
  },

  // ê³µì—°ì¥ì†Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ìƒíƒœì— ì €ì¥
  fetchMapData: async (id) => {
    try {
      const result = await fetchMapData(id); // API í˜¸ì¶œ
      console.log(result);
      if (result && result.dbs && result.dbs.db) {
        set({ mapData: result.dbs.db, error: null }); // ìƒíƒœì— ì €ì¥
        console.log(get().mapData);
      } else {
        set({ error: "No map data found", mapData: null });
      }
    } catch (error) {
      set({
        error: `Error fetching map data: ${error.message}`,
        mapData: null,
      });
    }
  },
}));

export default useKopisStore;
```

í•´ê²° ë¦¬í™í† ë§

```js
const { id } = useParams();

// ê³µì—° ìƒì„¸ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
const {
  data,
  isLoading: detailLoading,
  isError: detailError,
} = useQuery({
  queryKey: ["performanceDetail", id],
  queryFn: () => fetchDetailData(id),
});
const detailData = data?.dbs?.db;

if (detailLoading) {
  return <div>Loading...</div>;
}
if (detailError) {
  return <div>Error</div>;
}
```

2.

---

[ì»¤ë®¤ë‹ˆí‹°]

---

[ë¡œê·¸ì¸, íšŒì›ê°€ì…]

---

[ì¹´í…Œê³ ë¦¬]

ğŸ”¥ ë¬¸ì œì 

1. í•„í„° ë‚ ì§œê°’ê³¼ ë‚˜íƒ€ë‚œ ë°ì´í„° ê°’ì´ ë‹¤ë¥¸ ì´ìŠˆ ë°œìƒ

- í•„í„°ì— ì…ë ¥í•œ ë‚ ì§œê°’ê³¼ í•˜ë‹¨ì— ë‚˜íƒ€ë‚œ ê³µì—°ì˜ ë‚ ì§œê°’ì´ ë‹¤ë¥¸ ì´ìŠˆê°€ ë°œìƒí•˜ì˜€ìŒ
- ì•Œê³ ë³´ë‹ˆ APIìƒì—ì„œëŠ” 8ê¸€ì(20240920)ìœ¼ë¡œ ìš”ì²­ì„ ë°›ê³  ìˆì—ˆìœ¼ë‚˜ ì‹¤ì œë¡œ í•œ ìš”ì²­ì€ -(ëŒ€ì‹œ)ë¥¼ ì¶”ê°€í•˜ì—¬ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆì–´ ëŒ€ì‹œë¥¼ ì—†ì• ë„ë¡ replaceAllí•˜ì—¬ ìˆ˜ì •í•˜ì˜€ìŒ

```js
const { data, isLoading, isError, refetch } = useQuery({
  queryKey: [QUERY_KEY.category],
  queryFn: () => searchGenreAreaData(searchTerm, genre, area, row, startDate, endDate),
  keepPreviousData: true,
});
```

í•´ê²° ë°©ì•ˆ

```js
const { data, isLoading, isError, refetch } = useQuery({
  queryKey: [QUERY_KEY.category],
  queryFn: () => searchGenreAreaData(searchTerm, genre, area, row, startDate.replaceAll("-", ""), endDate.replaceAll("-", "")),
  keepPreviousData: true,
});
```

---
